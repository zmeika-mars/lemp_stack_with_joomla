# Установка LEMP стэка с Joomla CMS 

Шаги для устаноки LEMP стека с CMS Joomla :

##### 1. Склонировать себе репозиторий на сервер где установлен ansible
##### 2. Указать в inventory.yml сервер на который будут устанавливаться роль
   
  >( при тестировании роли использовалось подключения с ключами SSH,
   если авторизация будет осуществлять с использование пароля в inventory файл небоходимо добавить ansible_password в блоке hosts -> joomla под ansible_user)

##### 4. Для успешного выполнения роли небоходимо загруженная коллекция community.mysql
   
   4.1 Проверить установленная необходимая коллекция можно выполнив комануд *_ansible-galaxy collection list_*

   4.2 Если коллекция не установлена, коллекцию можно установить используя файл requirements.yml в репозитории

      > Команда для установки зависимости ansible-galaxy install -r <путь до файла>/requirements.yml
      > 
      > В репозитории файл находится по следующему пути roles/lemp_joomla/meta/requirements.yml
   
   
##### 4. Запустить установку

   Запустить установку можно двумя способами с зашифрованными данными и/или используя значения по умолчанию.

   Пример команды для запуска playbook без зашифрованных данных (используются значения заданные по умолчанию):

   >  **ansible-playbook -i inventory.yml lemp-cms_playbook.yml**


   Запуск playbook с зашифрованными данными Ansible-vault:

   >  **ansible-playbook -i inventory.yml lemp-cms_playbook.yml  -e "@secret.vault" --ask-vault-pass**
   
    -e "@secret.vault" - тут небоходимо указать путь до файла после @<путь до секрета> с зашифровааными данными, в данном случае запуск идет из тойже директории, где находится секрет 


   > *В файле secret_password.txt содержится пароль от секрета созданного с помощью ansible-vault*
   




*_**Чтобы открыть CMS joomla после установки небоходимо создать A - запись, изменить или оставить указанное значение server_name в файле joomla.conf.j2 ( файл находится в директории template -> roles/initapps/templates/),
либо в файле hosts (/etc/hosts) в ОС указать < IP адрес сервера где была 'проиграна' роль> <Доменнно имя указаное в server_name конфигурационного файла joomla.conf.j2 >**_*
